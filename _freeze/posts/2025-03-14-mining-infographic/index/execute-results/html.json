{
  "hash": "6047bef0ba34a2eaf13d6a254fd94198",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Metal content in Minnesotan mammals\"\ndescription: \"How has urbanization and industrialization impacted animals in Minnesota?\"\nauthor:\n  - name: Liz Peterson\n    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB)\ndate: 03-14-2025\nformat: html\nimage: mining.jpg\n---\n\n\n\n## Background\n\nHuman activity has been proven over time to have direct impacts on animal metal content. Too much metal can cause neurological and developmental damage in animals. Two of the biggest culprits of this are industry and urbanization. These two have been extremely prevalent in the state of Minnesota. Mining in the north near the Boundary Waters has been the biggest industry in the state for more than a century. Additionally, the mines in the south east of the state have been transformed in many cases into urban development. None of this is good for the animals, and it was especially bad when developers took no heed to be environmentally conscious. \n\nThis has lead me to a couple of questions: how has metal content varied over space and time in these mammals? Does this have correlation to where these mining sites are located? What about proximity to large human populations? Additionally, I was curious whether policy decisions in these areas had any effect on these findings. Specifially, there have been a set of policy decisions over the past 50 years in Minnesota that relate to leaded gasoline. I wondered if this might have any impact on lead levels specifically in these mammals.\n\n## Data Information\n\nThis dataset makes use of the University of Minnesota's Bell Museum of Natural History collection examining specimens of four mammal species (a mouse, shrew, bat and squirrel) to ask how tissue metal content has changed over a 94-year time period (1911-2005), and implications for measures of individual performance (body size and cranial capacity). The metal content of organisms is often elevated closer to cities, so these specimens were examined for spatial variation in metal exposure based on their proximity to human populations and the size of those populated areas at the time of collection. Analysis of mammal tissues focused on six heavy metals associated with human activity (Pb, Cd, Zn, Cu, Cr, Ni, Mn), to address whether these anthropogenic metal pollutants vary in concert with human activity.\n\n## Code\n\nIt is important to note that this analysis operates under an assumption about body size and metal content. Through extensive research, it seems that when this proportion of metal content to body size for small mammals ought not exceed 1.0. \n\nBefore we get into the code for building out my full infographic, we need to load our necessary libraries and read in our data. The following code includes a condensed version of the creation of all the plots in the infographic. Please unfold the code to look into the details of how I made the plots. Note that they were all edited in Affinity Designer 2 post creation. \n\n\n\n::: {.cell progress='false'}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load libraries\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(janitor)\nlibrary(ggplot2)\nlibrary(here)\nlibrary(tmap)\nlibrary(sf)\nlibrary(hrbrthemes)\nlibrary(tigris)\nlibrary(patchwork)\nlibrary(gridExtra)\nlibrary(grid)\nlibrary(corrplot)\n\n# Read in and clean data\ndf <- read_csv(here('posts/2025-03-14-mining-infographic/data/mammal_hvy_metals_by_pop_withGUIDs.csv')) %>%\n  clean_names() %>%\n  filter(!is.na(latitude) & !is.na(longitude))\n# add in more data cleaning post mortem, once I understand what variables I am interested in\n\nmine_locations <- read_csv(here('posts/2025-03-14-mining-infographic/data/mine_locations.csv')) %>% \n  clean_names()\n\n# This first plot builds up the map in the top left corner of the infographic, combining the USGS and EDI data. \n\n# merge \nmines_and_metals <- merge(x=df, y=mine_locations, by = \"county\", all.y=TRUE) %>% \n  filter(!is.na(fe))\n\nmining_locations <- mines_and_metals\n\nmn_shapefile <- states(cb=TRUE) %>% \n  filter(STUSPS == \"MN\")\n\nggplot() +\n  geom_sf(data = mn_shapefile, fill = \"lightgrey\", color = \"black\") +\n  geom_point(data = df, aes(x = longitude, y = latitude)\n             # find concerning metals amount to be able to make a gradient\n             ) +\n  geom_point(data = mining_locations, aes(x = longitude, y = latitude, color = commodity),\n             shape = 17, size = 3) +  # Overlay red triangles for mining sites\n  labs(\n    title = \"Mining Locations and Concerning Metal Content in Mammals\",\n    subtitle = \"Concerning metal content is defined as roughly 20 mg/kg\",\n    caption = \"Data Source: Environmental Data Initiative (EDI), published May 28, 2024\\nUnited States Geological Survey (USGS) Minerals Yearbook\"\n    ) +\n  guides(fill = guide_legend(title = \"Mining type: \")) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid = element_blank(),\n    axis.title.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.text.y = element_blank(),\n    axis.title.y = element_blank(),\n    legend.title = element_blank()\n    )\n\n# establish bounding box of msp \nmsp_lat_min <- 44.85\nmsp_lat_max <- 45.15\nmsp_long_min <- -93.45\nmsp_long_max <- -93.0\n\n# map bounded to msp area  \nggplot() +\n  geom_sf(data = mn_shapefile, fill = \"lightgrey\", color = \"black\") +\n  geom_point(data = df, aes(x = longitude, y = latitude)\n             # find concerning metals amount to be able to make a gradient\n             ) +\n  geom_point(data = mining_locations, aes(x = longitude, y = latitude, color = commodity),\n             shape = 17, size = 3) +  # Overlay red triangles for mining sites\n  xlim(msp_long_min, msp_long_max) +\n  ylim(msp_lat_min, msp_lat_max) +\n  labs(\n    title = \"Mining Locations and Concerning Metal Content in Mammals\",\n    subtitle = \"Concerning metal content is defined as roughly 20 mg/kg\",\n    caption = \"Data Source: Environmental Data Initiative (EDI), published May 28, 2024\\nUnited States Geological Survey (USGS) Minerals Yearbook\"\n    ) +\n  guides(fill = guide_legend(title = \"Mining type: \")) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid = element_blank(),\n    axis.title.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.text.y = element_blank(),\n    axis.title.y = element_blank(),\n    legend.title = element_blank()\n    )\n\n# Using patchwork\n# Full map (with no zoom)\nfull_map <- ggplot() +\n  geom_sf(data = mn_shapefile, fill = \"lightgrey\", color = \"black\") +\n  geom_point(data = df, aes(x = longitude, y = latitude)) +  # find concerning metals amount for gradient\n  geom_point(data = mining_locations, aes(x = longitude, y = latitude, color = commodity),\n             shape = 17, size = 3) +  # Overlay red triangles for mining sites\n  labs(\n    title = \"Mining Locations and Concerning Metal Content in Mammals\",\n    subtitle = \"Concerning metal content is defined as roughly 20 mg/kg\",\n    caption = \"Data Source: Environmental Data Initiative (EDI), published May 28, 2024\\nUnited States Geological Survey (USGS) Minerals Yearbook\"\n  ) +\n  guides(fill = guide_legend(title = \"Mining type: \")) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid = element_blank(),\n    axis.title.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.text.y = element_blank(),\n    axis.title.y = element_blank(),\n    legend.title = element_blank()\n  )\n\n# Zoomed-in map (Minneapolis-Saint Paul area)\nmsp_lat_min <- 44.85\nmsp_lat_max <- 45.15\nmsp_long_min <- -93.45\nmsp_long_max <- -93.0\n\nzoomed_in_map <- ggplot() +\n  geom_sf(data = mn_shapefile, fill = \"lightgrey\", color = \"black\") +\n  geom_point(data = df, aes(x = longitude, y = latitude)) +  # find concerning metals amount for gradient\n  geom_point(data = mining_locations, aes(x = longitude, y = latitude, color = commodity),\n             shape = 17, size = 3) +  # Overlay red triangles for mining sites\n  xlim(msp_long_min, msp_long_max) +\n  ylim(msp_lat_min, msp_lat_max) +\n  guides(fill = guide_legend(title = \"Mining type: \")) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid = element_blank(),\n    axis.title.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.text.y = element_blank(),\n    axis.title.y = element_blank(),\n    legend.title = element_blank()\n  )\n\n# Combine both plots using patchwork\ncombined_plot <- full_map + zoomed_in_map + plot_layout(ncol = 2)\n\n# Display the combined plot\ncombined_plot\n\n# Create categories for population size (this is an example; you can modify the breaks as needed)\n# Weâ€™ll divide into three categories: low, medium, high\n\n# This second plot shows the correlation between the high metal content in animals and the proximity to high population areas. To do this, I split the population data into three categories: low, medium, and high based on population size. \n\nmg_df <- df %>%\n  group_by(county) %>%\n  mutate(total_mg = sum(mg)) %>%\n  arrange(total_mg) %>% \n  ungroup() %>% \n  mutate(mg_prop = mg/total_length)\n\nfe_df <- df %>%\n  group_by(county) %>%\n  mutate(total_fe = sum(fe)) %>%\n  arrange(total_fe) %>% \n  mutate(fe_prop = fe/total_length) %>%\n  ungroup()\n\nfe_df_clean <- fe_df %>% \n  drop_na(mg)\n\nfe_df_clean$pop_size_category <- cut(fe_df_clean$closest_pop_size_at_time, \n                               breaks = c(-Inf, 1000, 10000, Inf), \n                               labels = c(\"Low\", \"Medium\", \"High\"))\n\n# Now, calculate the correlation for each group of population size\nlibrary(dplyr)\n\n# Create a function to calculate correlation for each group\ncorrelation_by_pop <- fe_df_clean %>%\n  group_by(pop_size_category) %>%\n  summarise(correlation = cor(mg, distance_to_pop, use = \"complete.obs\"))\n\n# Print out the correlation values for each population group\nprint(correlation_by_pop)\n\n# Visualize the correlation by population size category\nlibrary(ggplot2)\n\ncity_corr_plot <- ggplot(correlation_by_pop, aes(x = pop_size_category, y = correlation)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  labs(title = \"Correlation between Magnesium Levels and Distance to Nearest City by Population Size\",\n       x = \"Population Size Category\", y = \"Correlation\") +\n  theme_minimal()\ncity_corr_plot\n\n# The third plot simply shows the change in lead levels in our mammals over the past century. \n\npb_levels <- df %>%\n  mutate(pb_prop = pb/total_length) %>%\n  ggplot(aes(x = year_collected, y = pb)) +\n  geom_area(fill = \"#95B700\") +\n  geom_line(color = \"#006400\") +\n  theme_minimal() +\n  labs(\n    title = \"Lead levels in mammal tissue over time\",\n    subtitle = \"Pb level (ppm) is proportioned to animal size using length (mm)\",\n    x = \"Year\",\n    y = \"Pb Level\",\n    caption = \"Data Source: Environmental Data Initiative (EDI), published May 28, 2024. \\nCreators come from the University of Minnesota and The Minneapolis-St. Paul Long Term Ecological Research\") +\n  theme_ipsum() +\n  theme(axis.title.x = element_blank())\n\npb_levels\n# the average content of Mg in the body of most animals is about 0.4 Mg / kg of body weight\n\n# Finally, we have our heatmap that shows which counties have the highest proportion of high metal content in their mammals. I filtered this down to only include the highest of those counties, that is the ones that have a ratio over 1.5. \n\n# Combine the mg_df and fe_df dataframes into one long dataframe\ncombined_df <- bind_rows(\n  mg_df %>%\n    mutate(element = \"Magnesium\"),\n  fe_df %>%\n    mutate(element = \"Iron\")\n)\n\n# Calculate the average proportion for each county and element\ncombined_avg_df <- combined_df %>%\n  group_by(county, element) %>%\n  summarise(\n    avg_prop = mean(ifelse(element == \"Magnesium\", mg_prop, fe_prop), na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n# Reshape the data into a wide format\ncombined_df_wide <- combined_avg_df %>%\n  pivot_wider(names_from = element, values_from = avg_prop) %>% \n  filter(county != \"Morrison\")\n\n# View the reshaped data\nhead(combined_df_wide)\n\n# Create a full heatmap (all counties) for Iron\nheatmap_all <- ggplot(combined_df_wide, aes(x = county, y = \"Value\")) +\n  geom_tile(aes(fill = Iron), color = \"white\") +  # Fill with Iron values\n  scale_fill_gradient2(low = \"brown\", high = \"darkgreen\", mid = \"yellow\", midpoint = median(combined_df_wide$Iron, na.rm = TRUE)) +\n  coord_flip() +\n  theme_minimal() +\n  labs(\n    title = \"Iron Levels Across Minnesota Counties (All Counties)\",\n    x = \"County\",\n    y = \"Element Levels\",\n    fill = \"Iron Level\"\n  ) +\n  theme(\n    axis.title.y = element_blank(),\n    axis.title.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.ticks.x = element_blank(),\n    title = element_blank()\n    )\n\n# Filter the data for counties with Iron values above 5\ncombined_df_filtered <- combined_df_wide %>%\n  filter(Iron > 1.5)  # Only include counties with Iron values > 5\n\n# Reorder the counties based on Iron values (from highest to lowest)\ncombined_df_filtered <- combined_df_filtered %>%\n  mutate(county = reorder(county, Iron, FUN = function(x) -x))  # Reorder from highest to lowest Iron\n\n# Create a heatmap for counties with Iron values above 5, ordered by Iron levels\nheatmap_filtered <- ggplot(combined_df_filtered, aes(x = county, y = \"Value\")) +\n  geom_tile(aes(fill = Iron), color = \"white\") +  # Fill with Iron values\n  scale_fill_gradient2(low = \"brown\", high = \"darkgreen\", mid = \"yellow\", midpoint = median(combined_df_filtered$Iron, na.rm = TRUE)) +\n  coord_flip() +\n  theme_minimal() +\n  labs(\n    x = \"County\",\n    y = \"Element Levels\",\n    fill = \"Iron Level\",\n    caption = \"Data Source: Environmental Data Initiative (EDI), published May 28, 2024\\nUnited States Geological Survey (USGS) Minerals Yearbook\"\n  ) +\n  theme(\n    axis.title.y = element_blank(),\n    axis.title.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.ticks.x = element_blank(),\n    title = element_blank()\n  )\n\n# Arrange both heatmaps side by side\ngrid.arrange(heatmap_all, heatmap_filtered,\n             ncol = 2,\n             top = textGrob(\"Iron Levels in Mammals Across Minnesota Counties\"),\n             bottom = textGrob(\"Data Source: Environmental Data Initiative (EDI), published May 28, 2024\\nUnited States Geological Survey (USGS) Minerals Yearbook\",\n                               hjust = -0.15,\n                               gp = gpar(fontsize=10)))\n\nheatmap_all\nheatmap_filtered\n```\n:::\n\n\n\n\n## The infographic\n\nThis infographic is aimed at people who have a background in ecology and scientific research, enough to be inquisitive about how human activity might affect animals. The goal is for these people to see the infographic and understand where they should aim their political advocacy. As expected, it seems like the main focus should be this mining and industry that exists in the upper east side of the state, near the Boundary Water Canoe Area in Cook, Lake, and Saint Louis counties. This has been the meeting point of environmentalists and developers for quite some time now. It is my hope that this infographic could continue to spark conversation, but mostly that it could shed light on how important it is to protect our species living in these vulnerable areas. \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](mn_mining_map.svg){fig-align='center' width=50% height=40%}\n:::\n:::\n\n\n\n\n## Visual decisions\n\nBecause of my intended audience, I made some aesthetic choices that made the infographic less informal. Despite this, to add some levity and draw the reader in, I decided to open up with a joke. I wanted the theme, colors, and text to all be in the natural domain. That is, I thought green and darker colors would be applicable to the themes. I wanted to make sure not to overwhelm the observer, even though there was a lot of information to communicate. I started with a more formal typeface, but I ended up deciding that Kohinoor Bangla, a more informal sans serif font could better communicate my concepts. \n\nAlthough there weren't many people involved in my data and visualization work, I wanted to approach the project with a lens of care. The focus is on how the smallest beings often get overlooked, particularly in the face of large industrialization projects that don't prioritize the needs of these creatures. While this isn't directly a DEI lens, it is an inclusive perspective that considers animals. Ecology isn't my main focus at Bren, but this project has offered a valuable exploration into the challenges faced by those much smaller than myself.\n\nIt's also important to acknowledge the indigenous peoples who have long been stewards of the land in Minnesota. The Dakota tribe is native to the Minneapolis-Saint Paul area, and the Ojibwe tribe is native to the Boundary Waters region in northern Minnesota. Throughout the process of creating the infographic, I made sure to center these communities in the narrative.\n\n### References\nNative Governance Center. (n.d.). Our land acknowledgment statement. Native Governance Center. Retrieved from https://nativegov.org/about/our-land-acknowledgement-statement/\n\nRevisor of Statutes. (1984). Resolution 21 (Session Law 1984, Chapter 21). Minnesota Legislative Reference Library. Retrieved from https://www.revisor.mn.gov/laws/1984/0/Session+Law/Resolution/21/\n\nSnell-Rood, E. C., Kjaer, S. J., Marek-Spartz, M., Devitz, A.-C., & Jansa, S. A. (2024). Pronounced declines in heavy metal burdens of Minnesotan mammals over the last century. Environmental Science and Pollution Research, 31(4), 1234-1245. https://doi.org/10.1007/s11356-024-34667-y\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}